

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>payments package &mdash; Cobalt 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="rbac package" href="rbac.html" />
    <link rel="prev" title="organisations package" href="organisations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Cobalt
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Cobalt Modules</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">cobalt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="accounts.html">accounts package</a></li>
<li class="toctree-l2"><a class="reference internal" href="calendar_app.html">calendar_app package</a></li>
<li class="toctree-l2"><a class="reference internal" href="cobalt.html">cobalt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dashboard.html">dashboard package</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">events package</a></li>
<li class="toctree-l2"><a class="reference internal" href="forums.html">forums package</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">logs package</a></li>
<li class="toctree-l2"><a class="reference internal" href="manage.html">manage module</a></li>
<li class="toctree-l2"><a class="reference internal" href="masterpoints.html">masterpoints package</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html">notifications package</a></li>
<li class="toctree-l2"><a class="reference internal" href="organisations.html">organisations package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">payments package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.admin">payments.admin module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.apps">payments.apps module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.core">payments.core module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.forms">payments.forms module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.models">payments.models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.tests">payments.tests module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.urls">payments.urls module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments.views">payments.views module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-payments">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html">rbac package</a></li>
<li class="toctree-l2"><a class="reference internal" href="results.html">results package</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html">support package</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cobalt</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">cobalt</a> &raquo;</li>
        
      <li>payments package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/payments.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="payments-package">
<h1>payments package<a class="headerlink" href="#payments-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-payments.admin">
<span id="payments-admin-module"></span><h2>payments.admin module<a class="headerlink" href="#module-payments.admin" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="payments.admin.MemberTransactionAdmin">
<em class="property">class </em><code class="sig-prename descclassname">payments.admin.</code><code class="sig-name descname">MemberTransactionAdmin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">admin_site</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/admin.html#MemberTransactionAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.admin.MemberTransactionAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.admin.options.ModelAdmin</span></code></p>
<dl class="py method">
<dt id="payments.admin.MemberTransactionAdmin.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.admin.MemberTransactionAdmin.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.admin.MemberTransactionAdmin.search_fields">
<code class="sig-name descname">search_fields</code><em class="property"> = ['reference_no', 'type']</em><a class="headerlink" href="#payments.admin.MemberTransactionAdmin.search_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.admin.OrganisationTransactionAdmin">
<em class="property">class </em><code class="sig-prename descclassname">payments.admin.</code><code class="sig-name descname">OrganisationTransactionAdmin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">admin_site</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/admin.html#OrganisationTransactionAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.admin.OrganisationTransactionAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.admin.options.ModelAdmin</span></code></p>
<dl class="py method">
<dt id="payments.admin.OrganisationTransactionAdmin.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.admin.OrganisationTransactionAdmin.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.admin.OrganisationTransactionAdmin.search_fields">
<code class="sig-name descname">search_fields</code><em class="property"> = ['reference_no', 'type']</em><a class="headerlink" href="#payments.admin.OrganisationTransactionAdmin.search_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.admin.StripeTransactionAdmin">
<em class="property">class </em><code class="sig-prename descclassname">payments.admin.</code><code class="sig-name descname">StripeTransactionAdmin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">admin_site</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/admin.html#StripeTransactionAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.admin.StripeTransactionAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.admin.options.ModelAdmin</span></code></p>
<dl class="py method">
<dt id="payments.admin.StripeTransactionAdmin.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.admin.StripeTransactionAdmin.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.admin.StripeTransactionAdmin.search_fields">
<code class="sig-name descname">search_fields</code><em class="property"> = ['stripe_reference']</em><a class="headerlink" href="#payments.admin.StripeTransactionAdmin.search_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-payments.apps">
<span id="payments-apps-module"></span><h2>payments.apps module<a class="headerlink" href="#module-payments.apps" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="payments.apps.PaymentsConfig">
<em class="property">class </em><code class="sig-prename descclassname">payments.apps.</code><code class="sig-name descname">PaymentsConfig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">app_name</span></em>, <em class="sig-param"><span class="n">app_module</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/apps.html#PaymentsConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.apps.PaymentsConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.apps.config.AppConfig</span></code></p>
<dl class="py attribute">
<dt id="payments.apps.PaymentsConfig.name">
<code class="sig-name descname">name</code><em class="property"> = 'payments'</em><a class="headerlink" href="#payments.apps.PaymentsConfig.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-payments.core">
<span id="payments-core-module"></span><h2>payments.core module<a class="headerlink" href="#module-payments.core" title="Permalink to this headline">¶</a></h2>
<p>Handles all activities associated with payments that do not talk to users.</p>
<p>This module handles all of the functions that do not interact directly with
a user. i.e. they do not generally accept a <code class="docutils literal notranslate"><span class="pre">Request</span></code> and return an
<code class="docutils literal notranslate"><span class="pre">HttpResponse</span></code>. Arguably these could have been put directly into models.py
but it seems cleaner to store them here.</p>
<p>See also <a class="reference external" href="#module-payments.views">Payments Views</a>. This handles the user side of the interactions.
They both work together.</p>
<dl class="simple">
<dt>Key Points:</dt><dd><ul class="simple">
<li><p>Payments is a service module, it is requested to do things on behalf of
another module and does not know why it is doing them.</p></li>
<li><p>Payments are often not real time, for manual payments, the user will
be taken to another screen that interacts directly with Stripe, and for
automatic top up payments, the top up may fail and require user input.</p></li>
<li><p>The asynchronous nature of payments makes it more complex than many of
the Cobalt modules so the documentation needs to be of a higher standard.
See <a class="reference external" href="./payments_overview.html">Payments Overview</a> for more details.</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt id="payments.core.auto_topup_member">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">auto_topup_member</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">member</span></em>, <em class="sig-param"><span class="n">topup_required</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">payment_type</span><span class="o">=</span><span class="default_value">'Auto Top Up'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#auto_topup_member"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.auto_topup_member" title="Permalink to this definition">¶</a></dt>
<dd><p>process an a member.</p>
<p>Internal function to handle a member needing to process an auto top up.
This function deals with successful top ups and failed top ups. For
failed top ups it will notify the user and disable auto topups. It is
the calling functions problem to handle the consequences of the non-payment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- a User object.</strong> (<em>member</em>) – </p></li>
<li><p><strong>- the amount of the top up</strong> (<em>topup_required</em>) – </p></li>
<li><p><strong>the payment is larger than the top up amount. e.g. balance is 25</strong><strong>,</strong> (<em>if</em>) – </p></li>
<li><p><strong>up amount is 50</strong><strong>, </strong><strong>payment is 300.</strong> (<em>top</em>) – </p></li>
<li><p><strong>- defaults to Auto Top Up. We allow this to be overriden</strong> (<em>payment_type</em>) – </p></li>
<li><p><strong>that a member manually topping up their account using their registered</strong> (<em>so</em>) – </p></li>
<li><p><strong>top up card get the payment type of Manual Top Up on their statement.</strong> (<em>auto</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return_code - True for success, False for failure
message - explanation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.callback_router">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">callback_router</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">route_code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">route_payload</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tran</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">'Success'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#callback_router"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.callback_router" title="Permalink to this definition">¶</a></dt>
<dd><p>Central function to handle callbacks</p>
<p>Callbacks are an asynchronous way for us to let the calling application
know if a payment successed or not.</p>
<p>We could use a routing table for this but there will only ever be a small
number of callbacks in Cobalt so we are okay to hardcode it.</p>
<p>We should not get tran provided but do for early testing. This will be
removed later, but for now allows us to reverse the transaction for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- hard coded value to map to a function call</strong> (<em>route_code</em>) – </p></li>
<li><p><strong>- value to return to function</strong> (<em>route_payload</em>) – </p></li>
<li><p><strong>- for testing only. remove later</strong> (<em>tran</em>) – </p></li>
<li><p><strong>- Success</strong> (<em>status</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.get_balance">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">get_balance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">member</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#get_balance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.get_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets member account balance</p>
<p>This function returns the current balance of the member’s account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>member</strong> (<a class="reference internal" href="accounts.html#accounts.models.User" title="accounts.models.User"><em>User</em></a>) – A User object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The member’s current balance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.get_balance_detail">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">get_balance_detail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">member</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#get_balance_detail"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.get_balance_detail" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by dashboard to show basic information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>member</strong> – A User object - the member whose balance is required</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Keys - balance and last_top_up</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.payment_api">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">payment_api</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">description</span></em>, <em class="sig-param"><span class="n">amount</span></em>, <em class="sig-param"><span class="n">member</span></em>, <em class="sig-param"><span class="n">route_code</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">route_payload</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">organisation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">other_member</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_msg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">payment_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">url</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#payment_api"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.payment_api" title="Permalink to this definition">¶</a></dt>
<dd><p>API for payments from other parts of the application.</p>
<p>There is a user on the end of this who needs to know what is happening,
so we return a page that tells them. It could be:</p>
<ol class="arabic simple">
<li><p>A payment page for one off payments</p></li>
<li><p>A failed auto payment message</p></li>
<li><p>A success page from auto topup</p></li>
<li><p>A success page because they had enough funds in the account</p></li>
</ol>
<p>The route_code provides a callback and the route_payload is the string
to return. For 3 and 4, the callback will be called before the page is
returned.</p>
<p>Payments should be the last step in the process for the calling application
as there is no way to return control to the application after payments is
done. Note: This would be possible if required.</p>
<p>amount is the amount to be deducted from the users account. A positive
amount is a charge, a negative amount is an incoming payment.</p>
<p>We accept either organisation as the counterpart for this payment or
other_member. We must have either an organisation or a member, but
we can’t pay to both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- standard request object</strong> (<em>request</em>) – </p></li>
<li><p><strong>- text description of the payment</strong> (<em>description</em>) – </p></li>
<li><p><strong>- how much</strong> (<em>amount</em>) – </p></li>
<li><p><strong>- User object related to the payment</strong> (<em>member</em>) – </p></li>
<li><p><strong>- code to map to a callback</strong> (<em>route_code</em>) – </p></li>
<li><p><strong>- value to retirn on completion</strong> (<em>route_payload</em>) – </p></li>
<li><p><strong>- linked organisation</strong> (<em>organisation</em>) – </p></li>
<li><p><strong>- User object</strong> (<em>other_member</em>) – </p></li>
<li><p><strong>- message for the log</strong> (<em>log_msg</em>) – </p></li>
<li><p><strong>- description of payment</strong> (<em>payment_type</em>) – </p></li>
<li><p><strong>- next url to go to</strong> (<em>url</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>request - page for user</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.stripe_auto_payment_intent">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">stripe_auto_payment_intent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#stripe_auto_payment_intent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.stripe_auto_payment_intent" title="Permalink to this definition">¶</a></dt>
<dd><p>Called from the auto top up webpage.</p>
<p>This is very similar to the one off payment. It lets Stripe
know to expect a credit card and provides a token to confirm
which one it is.</p>
<p>When a user is going to set up a credit card we
tell Stripe and Stripe gets ready for it. By this point in the process
we have handed over control to the Stripe code which calls this function
over Ajax.</p>
<p>This functions expects a json payload as part of <cite>request</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- This needs to contain a Json payload.</strong> (<em>request</em>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Json should include:
data{“stripe_customer_id”: This is the Stripe customer_id in our table
for the customer that we are handling}</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>{‘publishableKey’:? ‘clientSecret’:?}</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>publishableKey = our Public Stripe key,
clientSecret = client secret from Stripe</p>
</dd></dl>

<dl class="py function">
<dt id="payments.core.stripe_manual_payment_intent">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">stripe_manual_payment_intent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#stripe_manual_payment_intent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.stripe_manual_payment_intent" title="Permalink to this definition">¶</a></dt>
<dd><p>Called from the checkout webpage.</p>
<p>When a user is going to pay with a credit card we
tell Stripe and Stripe gets ready for it. By this point in the process
we have handed over control to the Stripe code which calls this function
over Ajax.</p>
<p>This functions expects a json payload as part of <cite>request</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- This needs to contain a Json payload.</strong> (<em>request</em>) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Json should include:
data{“id”: This is the StripeTransaction in our table that we are handling
“amount”: The amount in the system currency}</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>{‘publishableKey’:? ‘clientSecret’:?}</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>publishableKey = our Public Stripe key,
clientSecret = client secret from Stripe</p>
</dd></dl>

<dl class="py function">
<dt id="payments.core.stripe_webhook">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">stripe_webhook</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#stripe_webhook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.stripe_webhook" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback from Stripe webhook</p>
<p>In development, Stripe sends us everything. In production we can configure
the events that we receive. This is the only way for Stripe to communicate
with us.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stripe sends us multiple similar things, for example <em>payment.intent.succeeded</em>
will accompany anything that uses a payment intent. Be careful to only
handle one out of the multiple events.</p>
</div>
<p>For <strong>manual payments</strong> we can receive:</p>
<ul class="simple">
<li><p>payment.intent.created - ignore</p></li>
<li><p>charge.succeeded - process</p></li>
<li><p>payment.intent.succeeded - ignore</p></li>
</ul>
<p>For <strong>automatic payment set up</strong>, we get:</p>
<ul class="simple">
<li><p>customer.created - ignore</p></li>
<li><p>setup_intent.created - ignore</p></li>
<li><p>payment_method.attached - process</p></li>
<li><p>setup_intent.succeeded - ignore</p></li>
</ul>
<p>For <strong>automatic payments</strong> we get:</p>
<ul class="simple">
<li><p>payment_intent.succeeded - ignore</p></li>
<li><p>payment_intent.created - ignore</p></li>
<li><p>charge_succeeded - ignore (we already know this from the API call)</p></li>
</ul>
<p><strong>Meta data</strong></p>
<p>We use meta data to track what the event related to. This is added by us
when we call Stripe and returned to us by Stripe in the callback.</p>
<p>Fields used:</p>
<ul class="simple">
<li><p><strong>cobalt_tran_type</strong> - either <em>Manual</em> or <em>Auto</em> for manual and auto top up
transactions. If this is missing then the transaction is invalid.</p></li>
<li><p><strong>cobalt_pay_id</strong> - for manual payments this is the linked transaction in
MemberTransaction.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>json payload - see Stripe documentation</strong> (<em>Stripe</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPStatus Code</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.stripe_webhook_autosetup">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">stripe_webhook_autosetup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#stripe_webhook_autosetup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.stripe_webhook_autosetup" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles auto top up setup events from Stripe webhook</p>
<p>Called by stripe_webhook to look after successful incoming auto top up set ups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- the event payload from Stripe</strong> (<em>event</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse code - 200 for success, 400 for error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.stripe_webhook_manual">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">stripe_webhook_manual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#stripe_webhook_manual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.stripe_webhook_manual" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles manual payment events from Stripe webhook</p>
<p>Called by stripe_webhook to look after incoming manual payments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- the event payload from Stripe</strong> (<em>event</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse code - 200 for success, 400 for error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.test_callback">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">test_callback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">status</span></em>, <em class="sig-param"><span class="n">payload</span></em>, <em class="sig-param"><span class="n">tran</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#test_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.test_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Eventually I will be moved to another module. I am only here for testing purposes</p>
<p>I also shouldn’t have the 3rd parameter. I only get status and the payload that I provided
when I made the call to payments to get money from a member. I am responsible for my own
actions, but for testing I get the StripeTransaction passed so I can reverse it.</p>
</dd></dl>

<dl class="py function">
<dt id="payments.core.update_account">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">update_account</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">member</span></em>, <em class="sig-param"><span class="n">amount</span></em>, <em class="sig-param"><span class="n">description</span></em>, <em class="sig-param"><span class="n">log_msg</span></em>, <em class="sig-param"><span class="n">source</span></em>, <em class="sig-param"><span class="n">sub_source</span></em>, <em class="sig-param"><span class="n">payment_type</span></em>, <em class="sig-param"><span class="n">stripe_transaction</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">other_member</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">organisation</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#update_account"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.update_account" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to update a customer account</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- owner of the account</strong> (<em>member</em>) – </p></li>
<li><p><strong>- value</strong> (<em>amount</em>) – </p></li>
<li><p><strong>- to appear on statement</strong> (<em>description</em>) – </p></li>
<li><p><strong>- to appear on logs</strong> (<em>log_msg</em>) – </p></li>
<li><p><strong>- for logs</strong> (<em>sub_source</em>) – </p></li>
<li><p><strong>- for logs</strong> – </p></li>
<li><p><strong>- type of payment</strong> (<em>payment_type</em>) – </p></li>
<li><p><strong>- linked Stripe transaction</strong> (<em>stripe_transaction</em>) – </p></li>
<li><p><strong>- linked member</strong> (<em>other_member</em>) – </p></li>
<li><p><strong>- linked organisation</strong> (<em>organisation</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MemberTransaction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.core.update_organisation">
<code class="sig-prename descclassname">payments.core.</code><code class="sig-name descname">update_organisation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">organisation</span></em>, <em class="sig-param"><span class="n">amount</span></em>, <em class="sig-param"><span class="n">description</span></em>, <em class="sig-param"><span class="n">log_msg</span></em>, <em class="sig-param"><span class="n">source</span></em>, <em class="sig-param"><span class="n">sub_source</span></em>, <em class="sig-param"><span class="n">payment_type</span></em>, <em class="sig-param"><span class="n">other_organisation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">member</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/core.html#update_organisation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.core.update_organisation" title="Permalink to this definition">¶</a></dt>
<dd><p>method to update an organisations account</p>
</dd></dl>

</div>
<div class="section" id="module-payments.forms">
<span id="payments-forms-module"></span><h2>payments.forms module<a class="headerlink" href="#module-payments.forms" title="Permalink to this headline">¶</a></h2>
<p>Payment forms with validation</p>
<dl class="py class">
<dt id="payments.forms.AdjustMemberForm">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">AdjustMemberForm</code><span class="sig-paren">(</span><em class="sig-param">data=None</em>, <em class="sig-param">files=None</em>, <em class="sig-param">auto_id='id_%s'</em>, <em class="sig-param">prefix=None</em>, <em class="sig-param">initial=None</em>, <em class="sig-param">error_class=&lt;class 'django.forms.utils.ErrorList'&gt;</em>, <em class="sig-param">label_suffix=None</em>, <em class="sig-param">empty_permitted=False</em>, <em class="sig-param">instance=None</em>, <em class="sig-param">use_required_attribute=None</em>, <em class="sig-param">renderer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#AdjustMemberForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.AdjustMemberForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.models.ModelForm</span></code></p>
<p>For dodgy changes to members</p>
<dl class="py class">
<dt id="payments.forms.AdjustMemberForm.Meta">
<em class="property">class </em><code class="sig-name descname">Meta</code><a class="reference internal" href="_modules/payments/forms.html#AdjustMemberForm.Meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.AdjustMemberForm.Meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="payments.forms.AdjustMemberForm.Meta.fields">
<code class="sig-name descname">fields</code><em class="property"> = ('member', 'description', 'amount')</em><a class="headerlink" href="#payments.forms.AdjustMemberForm.Meta.fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustMemberForm.Meta.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#payments.forms.AdjustMemberForm.Meta.model" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#payments.models.MemberTransaction" title="payments.models.MemberTransaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">payments.models.MemberTransaction</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustMemberForm.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'member': &lt;django.forms.models.ModelChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.AdjustMemberForm.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustMemberForm.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {}</em><a class="headerlink" href="#payments.forms.AdjustMemberForm.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.AdjustMemberForm.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.AdjustMemberForm.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.AdjustOrgForm">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">AdjustOrgForm</code><span class="sig-paren">(</span><em class="sig-param">data=None</em>, <em class="sig-param">files=None</em>, <em class="sig-param">auto_id='id_%s'</em>, <em class="sig-param">prefix=None</em>, <em class="sig-param">initial=None</em>, <em class="sig-param">error_class=&lt;class 'django.forms.utils.ErrorList'&gt;</em>, <em class="sig-param">label_suffix=None</em>, <em class="sig-param">empty_permitted=False</em>, <em class="sig-param">instance=None</em>, <em class="sig-param">use_required_attribute=None</em>, <em class="sig-param">renderer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#AdjustOrgForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.AdjustOrgForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.models.ModelForm</span></code></p>
<p>For dodgy changes to orgs</p>
<dl class="py class">
<dt id="payments.forms.AdjustOrgForm.Meta">
<em class="property">class </em><code class="sig-name descname">Meta</code><a class="reference internal" href="_modules/payments/forms.html#AdjustOrgForm.Meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.AdjustOrgForm.Meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="payments.forms.AdjustOrgForm.Meta.fields">
<code class="sig-name descname">fields</code><em class="property"> = ('organisation', 'description', 'amount')</em><a class="headerlink" href="#payments.forms.AdjustOrgForm.Meta.fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustOrgForm.Meta.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#payments.forms.AdjustOrgForm.Meta.model" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#payments.models.OrganisationTransaction" title="payments.models.OrganisationTransaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">payments.models.OrganisationTransaction</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustOrgForm.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'organisation': &lt;django.forms.models.ModelChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.AdjustOrgForm.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.AdjustOrgForm.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {}</em><a class="headerlink" href="#payments.forms.AdjustOrgForm.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.AdjustOrgForm.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.AdjustOrgForm.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.DateForm">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">DateForm</code><span class="sig-paren">(</span><em class="sig-param">data=None</em>, <em class="sig-param">files=None</em>, <em class="sig-param">auto_id='id_%s'</em>, <em class="sig-param">prefix=None</em>, <em class="sig-param">initial=None</em>, <em class="sig-param">error_class=&lt;class 'django.forms.utils.ErrorList'&gt;</em>, <em class="sig-param">label_suffix=None</em>, <em class="sig-param">empty_permitted=False</em>, <em class="sig-param">field_order=None</em>, <em class="sig-param">use_required_attribute=None</em>, <em class="sig-param">renderer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#DateForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.DateForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.forms.Form</span></code></p>
<p>for simple from to date ranges</p>
<dl class="py attribute">
<dt id="payments.forms.DateForm.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'from_date': &lt;django.forms.fields.DateField object&gt;, 'to_date': &lt;django.forms.fields.DateField object&gt;}</em><a class="headerlink" href="#payments.forms.DateForm.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.DateForm.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {'from_date': &lt;django.forms.fields.DateField object&gt;, 'to_date': &lt;django.forms.fields.DateField object&gt;}</em><a class="headerlink" href="#payments.forms.DateForm.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.DateForm.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.DateForm.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.ManualTopup">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">ManualTopup</code><span class="sig-paren">(</span><em class="sig-param">data=None</em>, <em class="sig-param">files=None</em>, <em class="sig-param">auto_id='id_%s'</em>, <em class="sig-param">prefix=None</em>, <em class="sig-param">initial=None</em>, <em class="sig-param">error_class=&lt;class 'django.forms.utils.ErrorList'&gt;</em>, <em class="sig-param">label_suffix=None</em>, <em class="sig-param">empty_permitted=False</em>, <em class="sig-param">field_order=None</em>, <em class="sig-param">use_required_attribute=None</em>, <em class="sig-param">renderer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#ManualTopup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.ManualTopup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.forms.Form</span></code></p>
<p>Manual top up form</p>
<dl class="py attribute">
<dt id="payments.forms.ManualTopup.CARD_CHOICES">
<code class="sig-name descname">CARD_CHOICES</code><em class="property"> = [('Existing', 'Use Registered Card'), ('Another', 'Use Another Card')]</em><a class="headerlink" href="#payments.forms.ManualTopup.CARD_CHOICES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.ManualTopup.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'card_choice': &lt;django.forms.fields.ChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.ManualTopup.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.ManualTopup.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#ManualTopup.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.ManualTopup.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>validation for the amount field</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.forms.ManualTopup.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'card_choice': &lt;django.forms.fields.ChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.ManualTopup.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.ManualTopup.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.ManualTopup.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.MemberTransfer">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">MemberTransfer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#MemberTransfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.MemberTransfer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.forms.Form</span></code></p>
<p>M2M transfer form</p>
<dl class="py attribute">
<dt id="payments.forms.MemberTransfer.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'transfer_to': &lt;django.forms.models.ModelChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.MemberTransfer.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.MemberTransfer.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'transfer_to': &lt;django.forms.models.ModelChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.MemberTransfer.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.MemberTransfer.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.MemberTransfer.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.SettlementForm">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">SettlementForm</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#SettlementForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.SettlementForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.forms.Form</span></code></p>
<p>For payments to Orgs</p>
<dl class="py attribute">
<dt id="payments.forms.SettlementForm.CARD_CHOICES">
<code class="sig-name descname">CARD_CHOICES</code><em class="property"> = [('Dummy', 'Dummy')]</em><a class="headerlink" href="#payments.forms.SettlementForm.CARD_CHOICES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.SettlementForm.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'settle_list': &lt;django.forms.fields.MultipleChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.SettlementForm.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.SettlementForm.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {'settle_list': &lt;django.forms.fields.MultipleChoiceField object&gt;}</em><a class="headerlink" href="#payments.forms.SettlementForm.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.SettlementForm.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.SettlementForm.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.forms.TestTransaction">
<em class="property">class </em><code class="sig-prename descclassname">payments.forms.</code><code class="sig-name descname">TestTransaction</code><span class="sig-paren">(</span><em class="sig-param">data=None</em>, <em class="sig-param">files=None</em>, <em class="sig-param">auto_id='id_%s'</em>, <em class="sig-param">prefix=None</em>, <em class="sig-param">initial=None</em>, <em class="sig-param">error_class=&lt;class 'django.forms.utils.ErrorList'&gt;</em>, <em class="sig-param">label_suffix=None</em>, <em class="sig-param">empty_permitted=False</em>, <em class="sig-param">field_order=None</em>, <em class="sig-param">use_required_attribute=None</em>, <em class="sig-param">renderer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/forms.html#TestTransaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.forms.TestTransaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.forms.forms.Form</span></code></p>
<p>Temporary - will be removed</p>
<dl class="py attribute">
<dt id="payments.forms.TestTransaction.base_fields">
<code class="sig-name descname">base_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'organisation': &lt;django.forms.models.ModelChoiceField object&gt;, 'type': &lt;django.forms.fields.ChoiceField object&gt;, 'url': &lt;django.forms.fields.CharField object&gt;}</em><a class="headerlink" href="#payments.forms.TestTransaction.base_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.forms.TestTransaction.declared_fields">
<code class="sig-name descname">declared_fields</code><em class="property"> = {'amount': &lt;django.forms.fields.DecimalField object&gt;, 'description': &lt;django.forms.fields.CharField object&gt;, 'organisation': &lt;django.forms.models.ModelChoiceField object&gt;, 'type': &lt;django.forms.fields.ChoiceField object&gt;, 'url': &lt;django.forms.fields.CharField object&gt;}</em><a class="headerlink" href="#payments.forms.TestTransaction.declared_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.forms.TestTransaction.media">
<em class="property">property </em><code class="sig-name descname">media</code><a class="headerlink" href="#payments.forms.TestTransaction.media" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-payments.models">
<span id="payments-models-module"></span><h2>payments.models module<a class="headerlink" href="#module-payments.models" title="Permalink to this headline">¶</a></h2>
<p>Model definitions for Payments.</p>
<p>See <a class="reference external" href="./payments_overview.html">Payments Overview</a> for more details.</p>
<dl class="py class">
<dt id="payments.models.AbstractTransaction">
<em class="property">class </em><code class="sig-prename descclassname">payments.models.</code><code class="sig-name descname">AbstractTransaction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#AbstractTransaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.AbstractTransaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.db.models.base.Model</span></code></p>
<p>Common attributes for the other transaction classes</p>
<dl class="py class">
<dt id="payments.models.AbstractTransaction.Meta">
<em class="property">class </em><code class="sig-name descname">Meta</code><a class="reference internal" href="_modules/payments/models.html#AbstractTransaction.Meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.AbstractTransaction.Meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.Meta.abstract">
<code class="sig-name descname">abstract</code><em class="property"> = False</em><a class="headerlink" href="#payments.models.AbstractTransaction.Meta.abstract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.amount">
<code class="sig-name descname">amount</code><a class="headerlink" href="#payments.models.AbstractTransaction.amount" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.balance">
<code class="sig-name descname">balance</code><a class="headerlink" href="#payments.models.AbstractTransaction.balance" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.created_date">
<code class="sig-name descname">created_date</code><a class="headerlink" href="#payments.models.AbstractTransaction.created_date" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.description">
<code class="sig-name descname">description</code><a class="headerlink" href="#payments.models.AbstractTransaction.description" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py method">
<dt id="payments.models.AbstractTransaction.get_next_by_created_date">
<code class="sig-name descname">get_next_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.AbstractTransaction.get_next_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.AbstractTransaction.get_previous_by_created_date">
<code class="sig-name descname">get_previous_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.AbstractTransaction.get_previous_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.AbstractTransaction.get_type_display">
<code class="sig-name descname">get_type_display</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.CharField: type&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.AbstractTransaction.get_type_display" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.reference_no">
<code class="sig-name descname">reference_no</code><a class="headerlink" href="#payments.models.AbstractTransaction.reference_no" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.AbstractTransaction.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#payments.models.AbstractTransaction.type" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.models.MemberTransaction">
<em class="property">class </em><code class="sig-prename descclassname">payments.models.</code><code class="sig-name descname">MemberTransaction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#MemberTransaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.MemberTransaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#payments.models.AbstractTransaction" title="payments.models.AbstractTransaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">payments.models.AbstractTransaction</span></code></a></p>
<p>Member Transactions. May have a linked transaction.</p>
<dl class="py exception">
<dt id="payments.models.MemberTransaction.DoesNotExist">
<em class="property">exception </em><code class="sig-name descname">DoesNotExist</code><a class="headerlink" href="#payments.models.MemberTransaction.DoesNotExist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.ObjectDoesNotExist</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="payments.models.MemberTransaction.MultipleObjectsReturned">
<em class="property">exception </em><code class="sig-name descname">MultipleObjectsReturned</code><a class="headerlink" href="#payments.models.MemberTransaction.MultipleObjectsReturned" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.MultipleObjectsReturned</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.evententryplayer_set">
<code class="sig-name descname">evententryplayer_set</code><a class="headerlink" href="#payments.models.MemberTransaction.evententryplayer_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related objects manager on the reverse side of a
many-to-one relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Parent.children</span></code> is a <code class="docutils literal notranslate"><span class="pre">ReverseManyToOneDescriptor</span></code> instance.</p>
<p>Most of the implementation is delegated to a dynamically defined manager
class built by <code class="docutils literal notranslate"><span class="pre">create_forward_many_to_many_manager()</span></code> defined below.</p>
</dd></dl>

<dl class="py method">
<dt id="payments.models.MemberTransaction.get_next_by_created_date">
<code class="sig-name descname">get_next_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.MemberTransaction.get_next_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.MemberTransaction.get_previous_by_created_date">
<code class="sig-name descname">get_previous_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.MemberTransaction.get_previous_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.MemberTransaction.get_type_display">
<code class="sig-name descname">get_type_display</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.CharField: type&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.MemberTransaction.get_type_display" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.id">
<code class="sig-name descname">id</code><a class="headerlink" href="#payments.models.MemberTransaction.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.member">
<code class="sig-name descname">member</code><a class="headerlink" href="#payments.models.MemberTransaction.member" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.member_id">
<code class="sig-name descname">member_id</code><a class="headerlink" href="#payments.models.MemberTransaction.member_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.objects">
<code class="sig-name descname">objects</code><em class="property"> = &lt;django.db.models.manager.Manager object&gt;</em><a class="headerlink" href="#payments.models.MemberTransaction.objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.organisation">
<code class="sig-name descname">organisation</code><a class="headerlink" href="#payments.models.MemberTransaction.organisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.organisation_id">
<code class="sig-name descname">organisation_id</code><a class="headerlink" href="#payments.models.MemberTransaction.organisation_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.other_member">
<code class="sig-name descname">other_member</code><a class="headerlink" href="#payments.models.MemberTransaction.other_member" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.other_member_id">
<code class="sig-name descname">other_member_id</code><a class="headerlink" href="#payments.models.MemberTransaction.other_member_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.MemberTransaction.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#MemberTransaction.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.MemberTransaction.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the current instance. Override this in a subclass if you want to
control the saving process.</p>
<p>The ‘force_insert’ and ‘force_update’ parameters can be used to insist
that the “save” must be an SQL insert or update (or equivalent for
non-SQL backends), respectively. Normally, they should not be set.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.stripe_transaction">
<code class="sig-name descname">stripe_transaction</code><a class="headerlink" href="#payments.models.MemberTransaction.stripe_transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.MemberTransaction.stripe_transaction_id">
<code class="sig-name descname">stripe_transaction_id</code><a class="headerlink" href="#payments.models.MemberTransaction.stripe_transaction_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.models.OrganisationTransaction">
<em class="property">class </em><code class="sig-prename descclassname">payments.models.</code><code class="sig-name descname">OrganisationTransaction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#OrganisationTransaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.OrganisationTransaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#payments.models.AbstractTransaction" title="payments.models.AbstractTransaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">payments.models.AbstractTransaction</span></code></a></p>
<p>Organisation transactions.</p>
<dl class="py exception">
<dt id="payments.models.OrganisationTransaction.DoesNotExist">
<em class="property">exception </em><code class="sig-name descname">DoesNotExist</code><a class="headerlink" href="#payments.models.OrganisationTransaction.DoesNotExist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.ObjectDoesNotExist</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="payments.models.OrganisationTransaction.MultipleObjectsReturned">
<em class="property">exception </em><code class="sig-name descname">MultipleObjectsReturned</code><a class="headerlink" href="#payments.models.OrganisationTransaction.MultipleObjectsReturned" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.MultipleObjectsReturned</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="payments.models.OrganisationTransaction.get_next_by_created_date">
<code class="sig-name descname">get_next_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.OrganisationTransaction.get_next_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.OrganisationTransaction.get_previous_by_created_date">
<code class="sig-name descname">get_previous_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.OrganisationTransaction.get_previous_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.OrganisationTransaction.get_type_display">
<code class="sig-name descname">get_type_display</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.CharField: type&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.OrganisationTransaction.get_type_display" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.id">
<code class="sig-name descname">id</code><a class="headerlink" href="#payments.models.OrganisationTransaction.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.member">
<code class="sig-name descname">member</code><a class="headerlink" href="#payments.models.OrganisationTransaction.member" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.member_id">
<code class="sig-name descname">member_id</code><a class="headerlink" href="#payments.models.OrganisationTransaction.member_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.objects">
<code class="sig-name descname">objects</code><em class="property"> = &lt;django.db.models.manager.Manager object&gt;</em><a class="headerlink" href="#payments.models.OrganisationTransaction.objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.organisation">
<code class="sig-name descname">organisation</code><a class="headerlink" href="#payments.models.OrganisationTransaction.organisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.organisation_id">
<code class="sig-name descname">organisation_id</code><a class="headerlink" href="#payments.models.OrganisationTransaction.organisation_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.other_organisation">
<code class="sig-name descname">other_organisation</code><a class="headerlink" href="#payments.models.OrganisationTransaction.other_organisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.other_organisation_id">
<code class="sig-name descname">other_organisation_id</code><a class="headerlink" href="#payments.models.OrganisationTransaction.other_organisation_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.OrganisationTransaction.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#OrganisationTransaction.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.OrganisationTransaction.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the current instance. Override this in a subclass if you want to
control the saving process.</p>
<p>The ‘force_insert’ and ‘force_update’ parameters can be used to insist
that the “save” must be an SQL insert or update (or equivalent for
non-SQL backends), respectively. Normally, they should not be set.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.stripe_transaction">
<code class="sig-name descname">stripe_transaction</code><a class="headerlink" href="#payments.models.OrganisationTransaction.stripe_transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related object on the forward side of a many-to-one or
one-to-one (via ForwardOneToOneDescriptor subclass) relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Child.parent</span></code> is a <code class="docutils literal notranslate"><span class="pre">ForwardManyToOneDescriptor</span></code> instance.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.OrganisationTransaction.stripe_transaction_id">
<code class="sig-name descname">stripe_transaction_id</code><a class="headerlink" href="#payments.models.OrganisationTransaction.stripe_transaction_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="payments.models.StripeTransaction">
<em class="property">class </em><code class="sig-prename descclassname">payments.models.</code><code class="sig-name descname">StripeTransaction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/models.html#StripeTransaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.models.StripeTransaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.db.models.base.Model</span></code></p>
<p>Our record of Stripe transactions.</p>
<p>Only stores basic information, for the full details use the
stripe_reference to look up the transaction in Stripe.</p>
<dl class="py exception">
<dt id="payments.models.StripeTransaction.DoesNotExist">
<em class="property">exception </em><code class="sig-name descname">DoesNotExist</code><a class="headerlink" href="#payments.models.StripeTransaction.DoesNotExist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.ObjectDoesNotExist</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="payments.models.StripeTransaction.MultipleObjectsReturned">
<em class="property">exception </em><code class="sig-name descname">MultipleObjectsReturned</code><a class="headerlink" href="#payments.models.StripeTransaction.MultipleObjectsReturned" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">django.core.exceptions.MultipleObjectsReturned</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.TRANSACTION_STATUS">
<code class="sig-name descname">TRANSACTION_STATUS</code><em class="property"> = [('Intent', 'Intent - received customer intent to pay from Stripe'), ('Pending', 'Pending - transaction approved by Stripe - awaiting confirmation'), ('Complete', 'Success - payment completed successfully'), ('Failed', 'Failed - payment failed')]</em><a class="headerlink" href="#payments.models.StripeTransaction.TRANSACTION_STATUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.amount">
<code class="sig-name descname">amount</code><a class="headerlink" href="#payments.models.StripeTransaction.amount" title="Permalink to this definition">¶</a></dt>
<dd><p>Amount of the transaction in currency unit (default Australian Dollars).
Be careful as Stripe stores the amount in cents, not dollars.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.created_date">
<code class="sig-name descname">created_date</code><a class="headerlink" href="#payments.models.StripeTransaction.created_date" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.description">
<code class="sig-name descname">description</code><a class="headerlink" href="#payments.models.StripeTransaction.description" title="Permalink to this definition">¶</a></dt>
<dd><p>Description of the transaction.</p>
</dd></dl>

<dl class="py method">
<dt id="payments.models.StripeTransaction.get_next_by_created_date">
<code class="sig-name descname">get_next_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.StripeTransaction.get_next_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.StripeTransaction.get_next_by_last_change_date">
<code class="sig-name descname">get_next_by_last_change_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: last_change_date&gt;</em>, <em class="sig-param">is_next=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.StripeTransaction.get_next_by_last_change_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.StripeTransaction.get_previous_by_created_date">
<code class="sig-name descname">get_previous_by_created_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: created_date&gt;</em>, <em class="sig-param">is_next=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.StripeTransaction.get_previous_by_created_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.StripeTransaction.get_previous_by_last_change_date">
<code class="sig-name descname">get_previous_by_last_change_date</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.DateTimeField: last_change_date&gt;</em>, <em class="sig-param">is_next=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.StripeTransaction.get_previous_by_last_change_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="payments.models.StripeTransaction.get_status_display">
<code class="sig-name descname">get_status_display</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">field=&lt;django.db.models.fields.CharField: status&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#payments.models.StripeTransaction.get_status_display" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.id">
<code class="sig-name descname">id</code><a class="headerlink" href="#payments.models.StripeTransaction.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.last_change_date">
<code class="sig-name descname">last_change_date</code><a class="headerlink" href="#payments.models.StripeTransaction.last_change_date" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_amount">
<code class="sig-name descname">linked_amount</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_amount" title="Permalink to this definition">¶</a></dt>
<dd><p>linked amount can be different to amount if the member had some money in their account already</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_member">
<code class="sig-name descname">linked_member</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_member" title="Permalink to this definition">¶</a></dt>
<dd><p>A stripe payment can be linked to a payment to an organisation or
to a member, but not both</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_member_id">
<code class="sig-name descname">linked_member_id</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_member_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_organisation">
<code class="sig-name descname">linked_organisation</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_organisation" title="Permalink to this definition">¶</a></dt>
<dd><p>A stripe payment can be linked to a payment to an organisation or
to a member, but not both</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_organisation_id">
<code class="sig-name descname">linked_organisation_id</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_organisation_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.linked_transaction_type">
<code class="sig-name descname">linked_transaction_type</code><a class="headerlink" href="#payments.models.StripeTransaction.linked_transaction_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of the transaction that we are linked to. This is payload on
StripeTransaction that is used to create the linked MemberTransaction or
OrganisationTransaction record.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.member">
<code class="sig-name descname">member</code><a class="headerlink" href="#payments.models.StripeTransaction.member" title="Permalink to this definition">¶</a></dt>
<dd><p>Link to the member(User object) that is associated with this transaction.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.member_id">
<code class="sig-name descname">member_id</code><a class="headerlink" href="#payments.models.StripeTransaction.member_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.membertransaction_set">
<code class="sig-name descname">membertransaction_set</code><a class="headerlink" href="#payments.models.StripeTransaction.membertransaction_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related objects manager on the reverse side of a
many-to-one relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Parent.children</span></code> is a <code class="docutils literal notranslate"><span class="pre">ReverseManyToOneDescriptor</span></code> instance.</p>
<p>Most of the implementation is delegated to a dynamically defined manager
class built by <code class="docutils literal notranslate"><span class="pre">create_forward_many_to_many_manager()</span></code> defined below.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.objects">
<code class="sig-name descname">objects</code><em class="property"> = &lt;django.db.models.manager.Manager object&gt;</em><a class="headerlink" href="#payments.models.StripeTransaction.objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.organisationtransaction_set">
<code class="sig-name descname">organisationtransaction_set</code><a class="headerlink" href="#payments.models.StripeTransaction.organisationtransaction_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Accessor to the related objects manager on the reverse side of a
many-to-one relation.</p>
<p>In the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">Parent</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Parent.children</span></code> is a <code class="docutils literal notranslate"><span class="pre">ReverseManyToOneDescriptor</span></code> instance.</p>
<p>Most of the implementation is delegated to a dynamically defined manager
class built by <code class="docutils literal notranslate"><span class="pre">create_forward_many_to_many_manager()</span></code> defined below.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.route_code">
<code class="sig-name descname">route_code</code><a class="headerlink" href="#payments.models.StripeTransaction.route_code" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.route_payload">
<code class="sig-name descname">route_payload</code><a class="headerlink" href="#payments.models.StripeTransaction.route_payload" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.status">
<code class="sig-name descname">status</code><a class="headerlink" href="#payments.models.StripeTransaction.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Status of the transaction. See TRANSACTION_STATUS for options.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_brand">
<code class="sig-name descname">stripe_brand</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_brand" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_country">
<code class="sig-name descname">stripe_country</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_country" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_currency">
<code class="sig-name descname">stripe_currency</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_currency" title="Permalink to this definition">¶</a></dt>
<dd><p>Stripe currency for the transaction.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_exp_month">
<code class="sig-name descname">stripe_exp_month</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_exp_month" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_exp_year">
<code class="sig-name descname">stripe_exp_year</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_exp_year" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_last4">
<code class="sig-name descname">stripe_last4</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_last4" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a deferred-loading field. When the value is read from this
object the first time, the query is executed.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_method">
<code class="sig-name descname">stripe_method</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Stripe payment method - always “Card”.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_receipt_url">
<code class="sig-name descname">stripe_receipt_url</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_receipt_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Stripe receipt URL. User can go directly to this for Stripe info.</p>
</dd></dl>

<dl class="py attribute">
<dt id="payments.models.StripeTransaction.stripe_reference">
<code class="sig-name descname">stripe_reference</code><a class="headerlink" href="#payments.models.StripeTransaction.stripe_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference passed by Stripe. Use this to look up more detail within
Stripe itself.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-payments.tests">
<span id="payments-tests-module"></span><h2>payments.tests module<a class="headerlink" href="#module-payments.tests" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-payments.urls">
<span id="payments-urls-module"></span><h2>payments.urls module<a class="headerlink" href="#module-payments.urls" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-payments.views">
<span id="payments-views-module"></span><h2>payments.views module<a class="headerlink" href="#module-payments.views" title="Permalink to this headline">¶</a></h2>
<p>Handles all activities associated with payments that talk to users.</p>
<p>This module handles all of the functions that interact directly with
a user. i.e. they generally accept a <code class="docutils literal notranslate"><span class="pre">Request</span></code> and return an
<code class="docutils literal notranslate"><span class="pre">HttpResponse</span></code>.
See also <a class="reference external" href="#module-payments.core">Payments Core</a>. This handles the other side of the interactions.
They both work together.</p>
<dl class="simple">
<dt>Key Points:</dt><dd><ul class="simple">
<li><p>Payments is a service module, it is requested to do things on behalf of
another module and does not know why it is doing them.</p></li>
<li><p>Payments are often not real time, for manual payments, the user will
be taken to another screen that interacts directly with Stripe, and for
automatic top up payments, the top up may fail and require user input.</p></li>
<li><p>The asynchronous nature of payments makes it more complex than many of
the Cobalt modules so the documentation needs to be of a higher standard.
See <a class="reference external" href="./payments_overview.html">Payments Overview</a> for more details.</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt id="payments.views.admin_members_with_balance">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_members_with_balance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_members_with_balance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_members_with_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any open balances held by members</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.admin_members_with_balance_csv">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_members_with_balance_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_members_with_balance_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_members_with_balance_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any open balances held by members - as CSV</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse - CSV</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.admin_orgs_with_balance">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_orgs_with_balance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_orgs_with_balance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_orgs_with_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any open balances held by orgs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.admin_orgs_with_balance_csv">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_orgs_with_balance_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_orgs_with_balance_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_orgs_with_balance_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any open balances held by orgs - as CSV</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse - CSV</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.admin_view_manual_adjustments">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_view_manual_adjustments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_view_manual_adjustments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_view_manual_adjustments" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any open balances held by orgs - as CSV</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse (Can be CSV)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.admin_view_stripe_transactions">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">admin_view_stripe_transactions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#admin_view_stripe_transactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.admin_view_stripe_transactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows stripe transactions for an admin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse (can be CSV)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.cancel_auto_top_up">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">cancel_auto_top_up</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#cancel_auto_top_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.cancel_auto_top_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel auto top up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.manual_adjust_member">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">manual_adjust_member</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#manual_adjust_member"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.manual_adjust_member" title="Permalink to this definition">¶</a></dt>
<dd><p>make a manual adjustment on a member account</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.manual_adjust_org">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">manual_adjust_org</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#manual_adjust_org"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.manual_adjust_org" title="Permalink to this definition">¶</a></dt>
<dd><p>make a manual adjustment on an organisation account</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.manual_topup">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">manual_topup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#manual_topup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.manual_topup" title="Permalink to this definition">¶</a></dt>
<dd><p>Page to allow credit card top up regardless of auto status.</p>
<p>This page allows a member to add to their account using a credit card,
they can do this even if they have already set up for auto top up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.member_transfer">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">member_transfer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#member_transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.member_transfer" title="Permalink to this definition">¶</a></dt>
<dd><p>view to transfer $ to another member</p>
<p>This view allows a member to transfer money to another member.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.settlement">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">settlement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#settlement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.settlement" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>process payments to organisations. This is expected to be a monthly</dt><dd><p>activity.</p>
</dd>
</dl>
<p>At certain points in time an administrator will clear out the balances of
the organisations accounts and transfer actual money to them through the
banking system. This is not currently possible to do electronically so this
is a manual process.</p>
<p>The administrator should use this list to match with the bank transactions and
then confirm through this view that the payments have been made.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.setup_autotopup">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">setup_autotopup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#setup_autotopup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.setup_autotopup" title="Permalink to this definition">¶</a></dt>
<dd><p>view to sign up to auto top up.</p>
<p>Creates Stripe customer if not already defined.
Hands over to Stripe to process card.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Our page with Stripe code embedded.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement" title="Permalink to this definition">¶</a></dt>
<dd><p>Member statement view.</p>
<p>Basic view of statement showing transactions in a web page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- standard request object</strong> (<em>request</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_admin_summary">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_admin_summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_admin_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_admin_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Main statement page for system administrators</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_admin_view">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_admin_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">member_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_admin_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_admin_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Member statement view for administrators.</p>
<p>Basic view of statement showing transactions in a web page. Used by an
administrator to view a members statement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- standard request object</strong> (<em>request</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_common">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_common</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">user</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_common"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_common" title="Permalink to this definition">¶</a></dt>
<dd><p>Member statement view - common part across online, pdf and csv</p>
<p>Handles the non-formatting parts of statements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>user</strong> (<a class="reference internal" href="accounts.html#accounts.models.User" title="accounts.models.User"><em>User</em></a>) – standard user object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>5-element tuple containing</dt><dd><ul class="simple">
<li><p><strong>summary</strong> (<em>dict</em>): Basic info about user from MasterPoints</p></li>
<li><p><strong>club</strong> (<em>str</em>): Home club name</p></li>
<li><p><strong>balance</strong> (<em>float</em> or <em>str</em>): Users account balance</p></li>
<li><p><strong>auto_button</strong> (<em>bool</em>): status of auto top up</p></li>
<li><p><strong>events_list</strong> (<em>list</em>): list of MemberTransactions</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_csv">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">member_id</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Member statement view - csv download</p>
<p>Generates a CSV of the statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p></li>
<li><p><strong>member_id</strong> (<em>int</em>) – id of member to view, defaults to logged in user</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CSV headed response with CSV statement data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_csv_org">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_csv_org</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">org_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_csv_org"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_csv_org" title="Permalink to this definition">¶</a></dt>
<dd><p>Organisation statement CSV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> – standard request object</p></li>
<li><p><strong>org_id</strong> – organisation to view</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CSV</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_org">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_org</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">org_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_org"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_org" title="Permalink to this definition">¶</a></dt>
<dd><p>Organisation statement view.</p>
<p>Basic view of statement showing transactions in a web page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> – standard request object</p></li>
<li><p><strong>org_id</strong> – organisation to view</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_org_summary_ajax">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_org_summary_ajax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">org_id</span></em>, <em class="sig-param"><span class="n">range</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_org_summary_ajax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_org_summary_ajax" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the org statement when the summary date range changes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p></li>
<li><p><strong>org_id</strong> (<em>int</em>) – pk of the org to query</p></li>
<li><p><strong>range</strong> (<em>str</em>) – range to include in summary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data for table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.statement_pdf">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">statement_pdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#statement_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.statement_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Member statement view - csv download</p>
<p>Generates a PDF of the statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PDF headed response with PDF statement data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.stripe_autotopup_confirm">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">stripe_autotopup_confirm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#stripe_autotopup_confirm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.stripe_autotopup_confirm" title="Permalink to this definition">¶</a></dt>
<dd><p>User has been told by Stripe that auto top up went through.</p>
<p>This is called by the web page after Stripe confirms that auto top up is approved.
Because this originates from the client we do not trust it, but we do move
the status to Pending unless it is already Confirmed (timing issues).</p>
<p>For manual payments we update the transaction, but for auto top up there is
no transaction so we record this on the User object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – stasndard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.stripe_autotopup_off">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">stripe_autotopup_off</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#stripe_autotopup_off"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.stripe_autotopup_off" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch off auto top up</p>
<p>This is called by the web page when a user submits new card details to
Stripe. This is the latest point that we can turn it off in case the
user aborts the change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – stasndard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.stripe_create_customer">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">stripe_create_customer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#stripe_create_customer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.stripe_create_customer" title="Permalink to this definition">¶</a></dt>
<dd><p>calls Stripe to register a customer.</p>
<p>Creates a new customer entry with Stripe and sets this member’s
stripe_customer_id to match the customer created. Also sets the
auto_amount for the member to the system default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.stripe_pending">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">stripe_pending</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#stripe_pending"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.stripe_pending" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows any pending stripe transactions.</p>
<p>Stripe transactions should never really be in a pending state unless
there is a problem. They go from intent to success usually. The only time
they will sit in pending is if Stripe is slow to talk to us or there is an
error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.stripe_webpage_confirm">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">stripe_webpage_confirm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em>, <em class="sig-param"><span class="n">stripe_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#stripe_webpage_confirm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.stripe_webpage_confirm" title="Permalink to this definition">¶</a></dt>
<dd><p>User has been told by Stripe that transaction went through.</p>
<p>This is called by the web page after Stripe confirms the transaction is approved.
Because this originates from the client we do not trust it, but we do move
the status to Pending unless it is already Confirmed (timing issues).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<em>HTTPRequest</em>) – stasndard request object</p></li>
<li><p><strong>stripe_id</strong> (<em>int</em>) – pk of stripe transaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="payments.views.test_payment">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">test_payment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#test_payment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.test_payment" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a temporary view that can be used to test making a payment against
a members account. This simulates them entering an event or paying a subscription.</p>
</dd></dl>

<dl class="py function">
<dt id="payments.views.update_auto_amount">
<code class="sig-prename descclassname">payments.views.</code><code class="sig-name descname">update_auto_amount</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/payments/views.html#update_auto_amount"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#payments.views.update_auto_amount" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the auto top up page when a user changes the amount of the auto top up.</p>
<p>The auto top up page has Stripe code on it so a standard form won’t work
for this. Instead we use a little Ajax code on the page to handle this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>HTTPRequest</em>) – standard request object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>“Successful”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HTTPResponse</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-payments">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-payments" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rbac.html" class="btn btn-neutral float-right" title="rbac package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="organisations.html" class="btn btn-neutral float-left" title="organisations package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, ABF

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>