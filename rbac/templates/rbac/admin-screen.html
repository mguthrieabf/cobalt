{% extends 'base.html' %}

{% block content %}

<h1>Administration</h1>

{% if not groups %}
<h2>Sorry, you don't appear to have any admin access at this time.</h2>
{% endif %}

{% for key, value in groups.items %}
<div>
  <div class="card col-lg-9">
    <div class="card-header card-header-primary">
      <h3 class="card-title">{{ key }} - Admin</h3>
    </div>
    <div class="card-body" style="text-align: center">

      <div class="container">
        <div class="row">

          <div class="col">
            <h3>Groups</h3>
            <select class="cobalt-group-select" id="{{ key }}-cobaltgroups" size="10">
              {% for v in value %}
                <option value="{{ v.id }}">{{ v.description }}</option>
              {% endfor %}
            </select><br>
            <button class="btn btn-success btn-sm">Add</button>
            <button class="btn btn-primary btn-sm">Delete</button>
          </div>

          <div class="col">
            <h3>Users</h3>
            <select id="{{ key }}-cobaltusers" size="10">
            </select><br>
            <button class="btn btn-success btn-sm">Add</button>
            <button class="btn btn-primary btn-sm">Delete</button>
          </div>

          <div class="col">
            <h3>Actions</h3>
            <select id="{{ key }}-cobaltactions" size="10">
            </select><br>
            <button class="btn btn-success btn-sm">Add</button>
            <button class="btn btn-primary btn-sm">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>
{% endfor %}

{% endblock %}

{% block footer %}
<script>
  jQuery(document).ready(function() {
    $('.cobalt-group-select').on('change', function() {
      var userlist = event.target.id.replace("cobaltgroups", "cobaltusers");
      var actionlist = event.target.id.replace("cobaltgroups", "cobaltactions");
      var groupid = this.value;
      $.getJSON("group-to-user/" + groupid + "/")
        .done(response => {
        $("#" + userlist).html(response['data']);
        $.getJSON("group-to-action/" + groupid + "/")
          .done(response => {
          $("#" + actionlist).html(response['data']);
        });
      });
    });
  });
</script>
{% endblock %}
